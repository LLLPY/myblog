{% extends 'base.html' %}
{% load static %}
{#{% block title %}学习星球{% endblock %}#}
{% block content %}


    {% comment %}头部的样式{% endcomment %}
    <style>
        * {
            box-sizing: border-box !important;
        }

        #myblog-head {
            width: 100%;
            height: 120px;
            border-bottom: 2px solid gray;
            overflow: hidden;
            position: relative;

        }

        #head-le {
            position: absolute;
            left: 0;
            width: 160px;
            height: 100%;

        }

        #head-le img {
            width: 100%;
            height: 100%;
        }

        #head-ri {
            position: absolute;
            right: -200px;
            height: 120px;
            width: 600px;
            border-radius: 10px;

        }

        #head-mi {
            left: 160px;
            position: absolute;
            height: 100%;
            width: 540px;
        }

        #head-mi ul {
            width: 100%;
            height: 120px;
            position: absolute;
        }

        #head-mi ul li {
            text-align: center;
            float: left;
            width: 30%;
            height: 95%;
            line-height: 71px;
            color: #FFFFFF !important;

        }

        #head-mi ul li a {
            font-size: 25px;
            border: 1px solid rgba(255, 255, 255, 0.5);
            -webkit-transition: all 0.5s;
            overflow: hidden;
            position: relative;
            text-decoration: none;
            display: inline-block;
            height: 60%;
            width: 90%;
            margin-top: 20%;
            border-radius: 10px;
            color: #FFFFFF;

        }

        #head-mi ul li a .iconfont {
            font-size: 25px;
        }

        #head-mi ul li a:hover {
            border: 1px solid rgba(255, 255, 255, 0);
            font-size: 28px;
        }

        #head-mi ul li a::before {
            content: '';
            position: absolute;
            left: 0;
            bottom: 0;
            width: 100%;
            height: 1px;
            background-color: rgba(255, 255, 255, 0.5);
            -webkit-transform: translate(-100%, -600%) rotate(9deg);
            transform: translate(-100%, -600%) rotate(9deg);
            -webkit-transition-timing-function: cubic-bezier(0.75, 0, 0.125, 1);
            transition-timing-function: cubic-bezier(0.75, 0, 0.125, 1);
            -webkit-transition: all 0.5s;
            transition: all 0.5s;
        }

        #head-mi ul li a:hover::before {
            -webkit-transform: translate(0, 0);
            transform: translate(0, 0);
        }


    </style>
    {% comment %}头部的样式end{% endcomment %}

    {% comment %}搜索框{% endcomment %}
    <link rel="stylesheet" type="text/css" href="{% static 'css/search1.css' %}"/>
    <script src="{% static 'js/search1.js' %}" type="text/javascript"></script>
    <script type="text/javascript">
        function searchToggle(obj, evt) {
            var container = $(obj).closest('.search-wrapper');
            var initSpan = document.getElementById('initSpan');
            var headRi = document.getElementById('head-ri');
            if (!container.hasClass('active')) {
                initSpan.innerHTML = `<span style="font-size: 24px; width: 100%;height: 100%;color: #974BE0"  class="iconfont">&#xe61a;</span>`;
                headRi.style.right = '0';
                headRi.style.backgroundColor = 'rgba(66, 66, 66, .5)';

                container.addClass('active');
                evt.preventDefault();
            } else if (container.hasClass('active') && $(obj).closest('.input-holder').length == 0) {
                container.removeClass('active');
                initSpan.innerHTML = '';
                headRi.style.right = '-200px';
                headRi.style.backgroundColor = 'transparent';

                // clear input
                container.find('.search-input').val('');
                // clear and hide result container when we press close
                container.find('.result-container').fadeOut(100, function () {
                    $(this).empty();
                });
            }
        }

        function submitFn(obj, evt) {
            value = $(obj).find('.search-input').val().trim();

            _html = "您搜索的关键词： ";
            if (!value.length) {
                _html = "关键词不能为空。";
            } else {
                _html = '您搜索的关键词：<b>' + value + '</b>'

                $ajax('post', {% url 'app:search' %}, {'keyword': value},
                    function (msg) {
                        let dataList = JSON.parse(msg)['data'];

                        {% comment %}如果返回的数据不为空{% endcomment %}
                        if (dataList.length) {
                            let learnContentLe = document.getElementById('learn-content-le');
                            let str = `<style>
                #learn-content-le .searchReault {
                    width: 850px;
                    height: 100px;
                    display: block !important;
                    margin: 30px 25px;
                    background-color: rgba(0, 0, 0, .3);
                    border-bottom: 2px solid gray;
                    -webkit-transition: all 0.3s;
                    transition: all 0.3s;
                    overflow: hidden!important; /*隐藏超出的部分*/


                }

                #learn-content-le .searchReault a {
                    width: 100%;
                    height: 100%;
                    display: inline-block;
                    text-decoration: none;
                    position: relative;
                    color: black ;

                }

                #learn-content-le .searchReault a h3 {
                    position: absolute;
                    height: 25%;
                    width: 70%;
                }

                #learn-content-le .searchReault a p {
                    position: absolute;
                    text-indent: 2em;
                    top: 25px;
                    font-size: 14px;
                    height: 75%;
                    width: 100%;
                    padding: 6px;
                    line-height: 23px;
                }

                #learn-content-le .searchReault a span {
                    position: absolute;
                    height: 25%;
                    width: 20%;
                    right: 20px;
                    top: 0;
                    font-size: 14px;
                    color: gray;
                    text-align: center;
                    line-height: 25px;
                }

                #learn-content-le .searchReault a span[class=author] {
                    right: 130px;
                }

                #learn-content-le .searchReault:hover {
                    -webkit-animation-name: move;
                    animation-name: move;
                    -webkit-animation-duration: 1s;
                    animation-duration: 1s;
                    -webkit-animation-fill-mode: both;
                    animation-fill-mode: both;
                    background-color: rgba(255, 255, 255, 0.2);
                }


            </style><div id="searchResultTitle" style="width: 900px;border-bottom: 2px dashed gray;padding-left: 10px;height: 50px;line-height: 50px;">搜索结果如下:</div>`;
                            let baseUrl = "{% url 'app:learningPlanet' 1 %}".toString();
                            let newUrl = '';
                            {% comment %}得到base_url{% endcomment %}
                            for (var ik = 0; ik < baseUrl.length - 1; ik++) {
                                newUrl += baseUrl[ik];
                            }

                            for (var i = 0; i < dataList.length; i++) {
                                str += ` <li class="searchReault">
                <a href="${newUrl}${dataList[i]['blogId']}"><h3><strong>${dataList[i]['title']}</strong></h3> <span>时间:${dataList[i]['createdTime']}</span>
                    <span class="author">作者:${dataList[i]['author']}</span>
                    <p>${dataList[i]['summary']}</p></a></li>`;
                            }
                            learnContentLe.innerHTML = str;

                        } else {

                            alert('无相关内容~');

                        }


                    },
                    function (msg) {
                        alert('失败');
                    }
                )


            }

            $(obj).find('.result-container').html('<span>' + _html + '</span>');
            $(obj).find('.result-container').fadeIn(100);

            evt.preventDefault();
        }
    </script>
    {% comment %}搜索框end{% endcomment %}



    {% comment %}head部分{% endcomment %}
    <div id="myblog-head">

        <div id="head-le">
            <img src="{% static 'imgs/favorite.png' %}" alt="0318-SPACE">
        </div>

        <div id="head-mi">
            <ul>

                <li><a href="{% url 'app:index' %}"><span class="iconfont">&#xe646;</span>首页</a></li>

                {% if learningPlanet %}
                    <li><a href="{% url 'app:playingPlanet' %}"><span class="iconfont">&#xe8e7;</span>快乐星球</a></li>
                {% else %}
                    <li><a href="{% url 'app:learningPlanet' blogid=toLearnPlanetLinkId %}"><span class="iconfont">&#xe646;</span>学习星球</a>
                    </li>

                {% endif %}
                <li><a href="{% url 'app:login' %}"><span class="iconfont">&#xec05;</span>登录</a></li>


            </ul>
        </div>

        <div id="head-ri">
            <form onSubmit="submitFn(this, event);">
                <div class="search-wrapper">
                    <div class="input-holder">
                        <input type="text" class="search-input" placeholder="请输入关键词"/>
                        <button id="myblogButton" class="search-icon" onClick="searchToggle(this, event);"><span></span>
                        </button>
                    </div>
                    <span id="initSpan" class="close" onClick="searchToggle(this, event);"></span>
                    <div class="result-container">

                    </div>
                </div>
            </form>
        </div>


    </div>

    {% comment %}content部分{% endcomment %}
    {% block content2 %}
    {% endblock %}






{% endblock %}
